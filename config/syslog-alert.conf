# syslog-alert.conf - unified configuration
#
# Single-file config replacing alert.conf + alert-contacts.conf
# Format: Tcl dict structure
#
# See USAGE.md for documentation

global {
    from    syslog@myhost.example.com
    debug   0
    trace   0
}

contacts {
    user1 {
        groups  {admin disk}
        email   user1@example.com
        page    1111111111@carrier.com
    }
    user2 {
        groups  oncall
        email   {user2work@example.com, user2home@example.com}
        page    2222222222@carrier.com
    }
    user3 {
        groups  disk
        page    3333333333@carrier.com
    }
}

rules {
    ignore-blanks {
        pattern  {"" "*-- MARK --*"}
        ignore   1
    }

    raid-event {
        pattern  {"*mdadm*"}
        subject  {$log(host) raid event}
        delay    86400
        email    {admin disk}
        page     admin
    }

    disk-event {
        pattern  {"*smartd*"}
        exclude  {{all="*someserver*smartd*Device: /dev/sde*"}}
        subject  {$log(host) disk event}
        delay    86400
        email    {admin disk}
    }

    backup-fail {
        pattern  {"*backups*fail*"}
        subject  {backup problem on $log(host)}
        delay    600
        email    admin
    }

    emergency {
        pattern  {"*emerg*"}
        subject  {$log(host) $log(program) emergency}
        delay    3600
        email    admin
        page     admin
    }

    default-catch {
        pattern  {default}
        subject  {$log(host) $log(msg)}
        delay    3600
        email    admin
        custom   {set subject "$log(host) event"}
    }
}
